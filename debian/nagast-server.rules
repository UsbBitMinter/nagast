#!/usr/bin/make -f


BUILD_ROOT=$(CURDIR)/debian/nagastd-tmp
install:
	rm -rf ${BUILD_ROOT}
    mkdir -p ${BUILD_ROOT}/usr/sbin/
    install -m 755 sbin/nagastd ${BUILD_ROOT}/usr/sbin/nagastd
    mkdir -p ${BUILD_ROOT}/usr/share/nagast/samples/
    cp samples/* ${BUILD_ROOT}/usr/share/nagast/samples/
    mkdir -p ${BUILD_ROOT}/etc/init/
    install -m 640 init/nagastd-master.conf ${BUILD_ROOT}/etc/init/nagastd-master.conf
    install -m 640 init/nagastd-node.conf ${BUILD_ROOT}/etc/init/nagastd-node.conf
    mkdir -p ${BUILD_ROOT}/usr/share/asterisk/agi-bin/
    install -m 750 agi-bin/nagios.agi ${BUILD_ROOT}/usr/share/asterisk/agi-bin/nagios.agi
    mkdir -p ${BUILD_ROOT}/var/spool/nagiosmessages/{ack,new,tmp}

build:
binary-indep:

binary-arch binary: build install
	if [ -d ${BUILD_ROOT} ] ; then dh_install --sourcedir=${BUILD_ROOT} ; fi
	dh_installdocs
	dh_installdeb
	dh_compress
	dh_fixperms
	dh_shlibdeps
	dh_gencontrol
	dh_md5sums
	dh_builddeb

.PHONY: build binary binary-arch binary-indep clean install
